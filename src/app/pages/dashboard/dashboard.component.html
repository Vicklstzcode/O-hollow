<canvas id="particles-canvas"></canvas>

<div class="min-h-screen relative">
  <!-- Navbar -->
  <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 glass-nav">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <a routerLink="/home" class="flex items-center gap-2 group">
          <div class="logo-container">
            <i data-lucide="zap" class="w-6 h-6 text-white"></i>
          </div>
          <div>
            <h1 class="logo-title">S.M.M.</h1>
            <p class="logo-subtitle">SYSTEM 2.0</p>
          </div>
        </a>

        <div class="hidden md:flex items-center gap-6 text-sm font-medium">
          <a routerLink="/home" class="nav-link">Início</a>
          <a routerLink="/dashboard" class="nav-link-active">Dashboard</a>
          <a routerLink="/home" class="nav-link">Heróis</a>
          <a routerLink="/favoritos" class="nav-link">Favoritos</a>
        </div>

        <div class="flex items-center gap-4">
          <button class="btn-back" routerLink="/home">
            <i data-lucide="arrow-left" class="w-4 h-4"></i>
            Voltar
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="pt-24 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto pb-12">
    
    <!-- Header -->
    <div class="header-section">
      <div class="header-icon-wrapper">
        <i data-lucide="layout-dashboard" class="w-8 h-8 text-white"></i>
      </div>
      <div>
        <h1 class="header-title">Dashboard de Controle</h1>
        <p class="header-subtitle">Visão geral do sistema S.M.M.</p>
      </div>
    </div>

    <!-- KPI Cards Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      
      <!-- Total Entidades -->
      <div class="kpi-card kpi-purple" style="animation-delay: 100ms;">
        <div class="kpi-header">
          <div>
            <p class="kpi-label">Total de Entidades</p>
            <p class="kpi-value">{{ totalEntidades }}</p>
          </div>
          <div class="kpi-icon-wrapper kpi-icon-purple">
            <i data-lucide="database" class="w-6 h-6"></i>
          </div>
        </div>
        <div class="kpi-footer">
          <span class="kpi-trend kpi-trend-neutral">
            <i data-lucide="activity" class="w-3 h-3"></i>
            Rastreadas no sistema
          </span>
        </div>
      </div>

      <!-- Ameaças Ativas -->
      <div class="kpi-card kpi-red" style="animation-delay: 200ms;">
        <div class="kpi-header">
          <div>
            <p class="kpi-label">Ameaças Ativas</p>
            <p class="kpi-value kpi-value-danger">{{ ameacasAtivas }}</p>
          </div>
          <div class="kpi-icon-wrapper kpi-icon-red">
            <i data-lucide="alert-triangle" class="w-6 h-6"></i>
          </div>
        </div>
        <div class="kpi-footer">
          <span class="kpi-trend kpi-trend-danger">
            <i data-lucide="trending-up" class="w-3 h-3"></i>
            Nível 95+ detectado
          </span>
        </div>
      </div>

      <!-- Novos Registros -->
      <div class="kpi-card kpi-green" style="animation-delay: 300ms;">
        <div class="kpi-header">
          <div>
            <p class="kpi-label">Novos Registros</p>
            <p class="kpi-value kpi-value-success">+{{ novosRegistros }}</p>
          </div>
          <div class="kpi-icon-wrapper kpi-icon-green">
            <i data-lucide="user-plus" class="w-6 h-6"></i>
          </div>
        </div>
        <div class="kpi-footer">
          <span class="kpi-trend kpi-trend-success">
            <i data-lucide="trending-up" class="w-3 h-3"></i>
            Adicionados hoje
          </span>
        </div>
      </div>

      <!-- Universos Monitorados -->
      <div class="kpi-card kpi-cyan" style="animation-delay: 400ms;">
        <div class="kpi-header">
          <div>
            <p class="kpi-label">Universos</p>
            <p class="kpi-value">{{ universosMonitorados }}</p>
          </div>
          <div class="kpi-icon-wrapper kpi-icon-cyan">
            <i data-lucide="globe" class="w-6 h-6"></i>
          </div>
        </div>
        <div class="kpi-footer">
          <span class="kpi-trend kpi-trend-neutral truncate" [title]="listaUniversos">
            <i data-lucide="layers" class="w-3 h-3"></i>
            {{ listaUniversos }}
          </span>
        </div>
      </div>
    </div>

    <!-- Charts Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
      
      <!-- Bar Chart -->
      <div class="chart-panel lg:col-span-2" style="animation-delay: 500ms;">
        <div class="chart-header">
          <div>
            <h3 class="chart-title">Nível de Poder Médio por Universo</h3>
            <p class="chart-subtitle">Comparativo entre os principais universos</p>
          </div>
          <div class="chart-actions">
            <button class="chart-btn">
              <i data-lucide="download" class="w-4 h-4"></i>
            </button>
            <button class="chart-btn">
              <i data-lucide="maximize-2" class="w-4 h-4"></i>
            </button>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="energyChart"></canvas>
        </div>
      </div>

      <!-- Pie Chart -->
      <div class="chart-panel" style="animation-delay: 600ms;">
        <div class="chart-header">
          <div>
            <h3 class="chart-title">Distribuição por Tipo</h3>
            <p class="chart-subtitle">Categorias de entidades</p>
          </div>
          <button class="chart-btn">
            <i data-lucide="pie-chart" class="w-4 h-4"></i>
          </button>
        </div>
        <div class="chart-container chart-container-centered">
          <canvas id="speciesChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Activity Table -->
    <div class="table-panel" style="animation-delay: 700ms;">
      <div class="table-header">
        <div class="flex items-center gap-3">
          <div class="table-icon">
            <i data-lucide="zap" class="w-5 h-5"></i>
          </div>
          <div>
            <h3 class="table-title">Últimas Atividades de Alto Nível</h3>
            <p class="table-subtitle">Entidades com nível de perigo elevado</p>
          </div>
        </div>
        <button class="btn-filter">
          <i data-lucide="filter" class="w-4 h-4"></i>
          Filtrar
        </button>
      </div>

      <div class="table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th class="table-th">Entidade</th>
              <th class="table-th hidden md:table-cell">Universo</th>
              <th class="table-th">Status</th>
              <th class="table-th">Nível de Perigo</th>
              <th class="table-th text-right">Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of atividadesRecentes" class="table-row">
              <td class="table-td">
                <div class="entity-cell">
                  <div class="entity-avatar">
                    <img [src]="item.image" [alt]="item.name" class="w-full h-full object-cover">
                  </div>
                  <span class="entity-name">{{ item.name }}</span>
                </div>
              </td>
              <td class="table-td hidden md:table-cell">
                <span class="universe-badge" 
                      [style.background-color]="item.color + '20'" 
                      [style.color]="item.color"
                      [style.border-color]="item.color + '40'">
                  {{ item.universe }}
                </span>
              </td>
              <td class="table-td">
                <span class="status-badge" [ngClass]="item.statusClass">
                  <span class="status-dot"></span>
                  {{ item.status }}
                </span>
              </td>
              <td class="table-td">
                <div class="danger-cell">
                  <div class="danger-bar">
                    <div class="danger-fill" 
                         [ngClass]="item.dangerBarClass" 
                         [style.width.%]="item.powerLevel"></div>
                  </div>
                  <span class="danger-text" [ngClass]="item.dangerClass">
                    {{ item.dangerText }}
                  </span>
                </div>
              </td>
              <td class="table-td text-right">
                <button [routerLink]="['/detalhes', item.id]" class="btn-action">
                  <span>Ver Dossiê</span>
                  <i data-lucide="arrow-right" class="w-4 h-4"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </main>
</div>